<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[产出产能平衡]]></title>
    <url>%2F2018%2F12%2F04%2F%E4%BA%A7%E5%87%BA%E4%BA%A7%E8%83%BD%E5%B9%B3%E8%A1%A1%2F</url>
    <content type="text"><![CDATA[请输入密码： Decrypt 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]]></content>
      <categories>
        <category>思想</category>
      </categories>
      <tags>
        <tag>读书笔记</tag>
        <tag>思想</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[窗口函数的使用]]></title>
    <url>%2F2018%2F11%2F30%2F%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[参考：https://n3xtchen.github.io/n3xtchen/spark/2017/01/24/spark200-window-functionhttps://www.jianshu.com/p/42be8650509f 代码实现123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118object DataFrameDemo extends App &#123; //1.6后基本上不用sc了，用spark.sparkContext代替 val sc = ConnectUtil.sc val spark = ConnectUtil.spark import spark.implicits._ /* 有些时候需要计算一些排序特征，窗口特征等，如一个店铺的首单特征。 对于这样的特征显然是不能简单通过groupBy操作来完成 即：第一列是订单，第二列是店铺，第三列是支付时间，第四列是价格。 1、统计每个店铺每个订单和前一单的价格和，如果通过groupBy来完成特别费劲。 2、店铺这个订单与前一单的差值，需要自定义聚合函数 还有计算前4秒的平均值、计算环比之类的，都要用到窗口函数。 */ val orders = Seq( ("o1", "s1", "2017-05-01", 100), ("o2", "s1", "2017-05-02", 200), ("o3", "s2", "2017-05-01", 200), ("o4", "s1", "2017-05-03", 200), ("o5", "s2", "2017-05-02", 100), ("o6", "s1", "2017-05-04", 300) ).toDF("order_id", "seller_id", "pay_time", "price") //打印分区信息 orders.printLocation() //店铺订单顺序 val rankSpec = Window.partitionBy("seller_id").orderBy("pay_time") orders.withColumn("rank", dense_rank.over(rankSpec)).show() val rankSpec2 = Window.partitionBy("seller_id").orderBy("price") orders.withColumn("rank2", rank.over(rankSpec2)).show() //1,2,2,4 orders.withColumn("dense_rank2", dense_rank.over(rankSpec2)).show()//1,2,2,3 //定义前一单和本单的窗口 val winSpec = Window.partitionBy("seller_id").orderBy("pay_time").rowsBetween(-1, 0) //店铺这个订单及前一单的价格和 orders.withColumn("sum_pay", sum("price").over(winSpec)).show() //店铺这个订单与前一单的平均值，用UDAF def getAvgUdaf:UserDefinedAggregateFunction = new MyAverage orders.withColumn("avg",getAvgUdaf($"price").over(winSpec)).show() orders.withColumn("avg2", avg("price").over(winSpec)).show() //每个店铺当前订单与前一单的差值,需要自定义聚合函数，或者lag函数 def getMinusUdaf:UserDefinedAggregateFunction = new MyMinus orders.withColumn("rank", dense_rank.over(rankSpec)) .withColumn("prePrice", lag("price", 1).over(rankSpec)) //前一行的值 .withColumn("minus", getMinusUdaf($"price").over(winSpec)) //在前面的基础上用UDF也行 .show() /* lag(field, n): 就是取从当前字段往前第n个值，这里是取前一行的值 first/last(): 提取这个分组特定排序的第一个最后一个，在获取用户退出的时候，你可能会用到 lag/lead(field, n): lead 就是 lag 相反的操作，这个用于做数据回测特别用，结果回推条件 */ //——————————————————————以下为自定义聚合函数UDAF—————————————————————————————————————————————— class MyAverage extends UserDefinedAggregateFunction&#123; //继承抽象函数必须实现以下方法 // 输入参数的数据类型 def inputSchema: StructType = StructType(StructField("value", LongType) :: Nil) // 缓冲区中进行聚合时，所处理的数据的类型 def bufferSchema: StructType = StructType(StructField("count", LongType) :: StructField("sum", DoubleType) :: Nil) // 初始化给定的聚合缓冲区，即聚合缓冲区的零值。 请注意，缓冲区内的数组和映射仍然是不可变的。 def initialize(buffer: MutableAggregationBuffer): Unit = &#123; buffer(0) = 0L //表示次数 buffer(1) = 0.0D //表示总和 &#125; //使用来自input的新输入数据更新给定的聚合缓冲区`buffer`。每个输入行调用一次。 def update(buffer: MutableAggregationBuffer, input: Row): Unit = &#123; if (!input.isNullAt(0)) &#123; buffer(0) = buffer.getLong(0) + 1L //次数加1 buffer(1) = buffer.getDouble(1) + input.getAs[Long](0).toDouble //求和 &#125; &#125; // 此函数是否始终在相同输入上返回相同的输出 def deterministic: Boolean = true // 合并两个聚合缓冲区并将更新的缓冲区值存储回“buffer1”。 // 当我们将两个部分聚合的数据合并在一起时调用此方法。 // Spark是分布式的，所以不同的区需要进行合并。 def merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = &#123; buffer1(0) = buffer1.getLong(0) + buffer2.getLong(0) //求次数 buffer1(1) = buffer1.getDouble(1) + buffer2.getDouble(1) //求和 &#125; //计算最终的结果 def evaluate(buffer: Row): Double = &#123; buffer.getDouble(1) / buffer.getLong(0).toDouble &#125; // 返回值的数据类型 def dataType: DataType = DoubleType &#125; class MyMinus extends UserDefinedAggregateFunction&#123; def inputSchema: StructType = StructType(StructField("value", LongType) :: Nil) def bufferSchema: StructType = StructType(StructField("minus", LongType) :: Nil) def initialize(buffer: MutableAggregationBuffer): Unit = &#123; buffer(0) = 0L //表示差值 &#125; def update(buffer: MutableAggregationBuffer, input: Row): Unit = &#123; if (!input.isNullAt(0)) &#123; //输入的后者减去前者 buffer(0) = input.getLong(0) - buffer.getLong(0) &#125; &#125; // 此函数是否始终在相同输入上返回相同的输出 def deterministic: Boolean = true def merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = &#123; //分区合并，也是后者减前者 buffer1(0) = buffer2.getLong(0) - buffer1.getLong(0) &#125; //计算最终的结果 def evaluate(buffer: Row): Long = &#123; buffer.getLong(0) &#125; // 返回值的数据类型 def dataType: DataType = LongType &#125; &#125;]]></content>
      <categories>
        <category>spark</category>
      </categories>
      <tags>
        <tag>spark</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[如何使用隐式转换扩展DataFrame和RDD以及其他的对象]]></title>
    <url>%2F2018%2F11%2F30%2F%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2%E6%89%A9%E5%B1%95DataFrame%E5%92%8CRDD%E4%BB%A5%E5%8F%8A%E5%85%B6%E4%BB%96%E7%9A%84%E5%AF%B9%E8%B1%A1%2F</url>
    <content type="text"><![CDATA[目的DataFrame可以点出来很多方法，都是DF内置的。 比如说：df.withColumn()，df.printSchema()。 但是如果你想打印df中的分区位置信息，以及每个key有多少记录。怎么才能点出来这个方法呢？ 实现工具类123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263package utilsimport org.apache.spark.rdd.RDDimport org.apache.spark.sql._//导入对应的规则类，以免出现警告import scala.language.implicitConversionsobject BaseUtil &#123; /** * DF的装饰类（隐式转换） */ class RichDataFrame(dataFrame: DataFrame)&#123; /** * 用来统计相同key的记录数，常用于调整数据倾斜 */ def printKeyNums(column: Column): Unit =&#123; val map = dataFrame.select(column).rdd.countByValue() println(s"一共$&#123;map.size&#125;个key") for ((key, num) &lt;- map) &#123; println(key + "共有" + num + "条记录") &#125; &#125; def printKeyNums(column: String): Unit =&#123; printKeyNums(dataFrame.col(column)) &#125; /** * 打印分区位置信息 */ def printLocation(): Unit =&#123; println("分区位置信息如下==============") dataFrame.rdd.mapPartitionsWithIndex(printLocationFunc).collect().foreach(println(_)) &#125; &#125; /** * 扩展df的方法，隐式转换 */ implicit def df2RichDF(src: DataFrame): RichDataFrame = new RichDataFrame(src) /** * RDD的装饰类（隐式转换）,不加泛型读取不到 */ class RichRDD(rdd:RDD[_ &lt;: Any])&#123; def printLocation(): Unit =&#123; println("分区位置信息如下==============") rdd.mapPartitionsWithIndex(printLocationFunc).collect().foreach(println(_)) &#125; &#125; /** * 扩展RDD的方法，隐式转换 */ implicit def rdd2RichRDD(src: RDD[_ &lt;: Any]): RichRDD = new RichRDD(src) /** * 打印rdd的分区信息，需要用mapPartitionsWithIndex方法。 * 使用方法：df.rdd.mapPartitionsWithIndex(printLocationFunc).collect().foreach(println(_)) */ def printLocationFunc(index: Int, iter: Iterator[Any]): Iterator[String] = &#123; iter.map(x =&gt; "分区" + index + "：" + x + "") &#125;&#125; 测试工具类1234567891011121314import utils.BaseUtil._object DataFrameDemo extends App &#123; val sc = ConnectUtil.sc val spark = ConnectUtil.spark import spark.implicits._ val df = spark.createDataset(Seq(("aaa", 1, 2), ("bbb", 3, 4), ("bbb", 1, 5), ("bbb", 2, 1), ("ccc", 4, 5), ("bbb", 4, 6))).toDF("key1", "key2", "key3") //测试 df.printKeyNums("key1") df.printKeyNums($"key1") df.printLocation() df.rdd.printLocation()&#125;]]></content>
      <categories>
        <category>spark</category>
      </categories>
      <tags>
        <tag>spark</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[spark调优]]></title>
    <url>%2F2018%2F11%2F22%2Fspark%E8%B0%83%E4%BC%98%2F</url>
    <content type="text"><![CDATA[开发调优http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_0S1att3u_Arv2julgO3DfqzJ 资源调优http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1aNUiT0jIkZS2vOo7b2A4zj0 数据倾斜调优http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1Bfyg63sj4Z62ijmli2HNs3A shuffle调优http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_0G6_680iZQjZ2SL00W3Mx2C1 UI界面详解http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_0Z68LH1WJkHy2ZzXL-3sPL0x 常见错误http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_0COQmb073k7328mFz10H6y5g]]></content>
      <categories>
        <category>spark</category>
      </categories>
      <tags>
        <tag>spark</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[软件基本操作]]></title>
    <url>%2F2018%2F11%2F18%2F%E8%BD%AF%E4%BB%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[此文件用来存放为知笔记中的软件基本操作，因为Hexo更新起来太麻烦，所以在这里只保存网址。 Wiz笔记基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_2G5fl23tBkJf2-yhOs0NQAvm GitHub高效利用http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_2xbFqV2d84ar2shT470Q0_00 IDEA基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_2JaDdJ1qykdj2so27N2QbLjp Chrome浏览器基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_29REm81QgAyn2HPyyl0GvLxx 梯子搭建http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_15_uf02yxQIH2uV1rO0fo5_z PyCharm基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_2jTrwm3nfQ1b25SGOL1xSKsy Anaconda基本操作(被PyCharm取代)http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_38Kfp21v9A912ogkRY2_MxcX Photoshop2015基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1wguN430BQVB2m50301ldceA SVN基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1xgVgp3xFkg82m1-4y0agm2S FastStone基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1XtmU22sxQB62DEWke0Q1si9 EditPlus基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1d6UAp2ckklB2WPhk01mXX1i Eclipse维护http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1umKrT2Sik7C2mh7_h3nmLWS Xmind基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1m1Ppn3JeA6V2XuoT93B3xCi Office基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_07RH0S1PZQTj2R-VY_1KucQu CorelDrawX6基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_39eROy3TVAaf2C0_OT3UWSXN]]></content>
      <categories>
        <category>软件</category>
      </categories>
      <tags>
        <tag>软件</tag>
      </tags>
  </entry>
</search>
