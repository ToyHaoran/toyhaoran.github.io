<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[产出产能平衡]]></title>
    <url>%2F2018%2F12%2F04%2F%E4%BA%A7%E5%87%BA%E4%BA%A7%E8%83%BD%E5%B9%B3%E8%A1%A1%2F</url>
    <content type="text"><![CDATA[请输入密码： Decrypt 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]]></content>
      <categories>
        <category>思想</category>
      </categories>
      <tags>
        <tag>读书笔记</tag>
        <tag>思想</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[窗口函数的使用]]></title>
    <url>%2F2018%2F11%2F30%2F%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[参考：https://n3xtchen.github.io/n3xtchen/spark/2017/01/24/spark200-window-functionhttps://www.jianshu.com/p/42be8650509f 代码实现123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118object DataFrameDemo extends App &#123; //1.6后基本上不用sc了，用spark.sparkContext代替 val sc = ConnectUtil.sc val spark = ConnectUtil.spark import spark.implicits._ /* 有些时候需要计算一些排序特征，窗口特征等，如一个店铺的首单特征。 对于这样的特征显然是不能简单通过groupBy操作来完成 即：第一列是订单，第二列是店铺，第三列是支付时间，第四列是价格。 1、统计每个店铺每个订单和前一单的价格和，如果通过groupBy来完成特别费劲。 2、店铺这个订单与前一单的差值，需要自定义聚合函数 还有计算前4秒的平均值、计算环比之类的，都要用到窗口函数。 */ val orders = Seq( ("o1", "s1", "2017-05-01", 100), ("o2", "s1", "2017-05-02", 200), ("o3", "s2", "2017-05-01", 200), ("o4", "s1", "2017-05-03", 200), ("o5", "s2", "2017-05-02", 100), ("o6", "s1", "2017-05-04", 300) ).toDF("order_id", "seller_id", "pay_time", "price") //打印分区信息 orders.printLocation() //店铺订单顺序 val rankSpec = Window.partitionBy("seller_id").orderBy("pay_time") orders.withColumn("rank", dense_rank.over(rankSpec)).show() val rankSpec2 = Window.partitionBy("seller_id").orderBy("price") orders.withColumn("rank2", rank.over(rankSpec2)).show() //1,2,2,4 orders.withColumn("dense_rank2", dense_rank.over(rankSpec2)).show()//1,2,2,3 //定义前一单和本单的窗口 val winSpec = Window.partitionBy("seller_id").orderBy("pay_time").rowsBetween(-1, 0) //店铺这个订单及前一单的价格和 orders.withColumn("sum_pay", sum("price").over(winSpec)).show() //店铺这个订单与前一单的平均值，用UDAF def getAvgUdaf:UserDefinedAggregateFunction = new MyAverage orders.withColumn("avg",getAvgUdaf($"price").over(winSpec)).show() orders.withColumn("avg2", avg("price").over(winSpec)).show() //每个店铺当前订单与前一单的差值,需要自定义聚合函数，或者lag函数 def getMinusUdaf:UserDefinedAggregateFunction = new MyMinus orders.withColumn("rank", dense_rank.over(rankSpec)) .withColumn("prePrice", lag("price", 1).over(rankSpec)) //前一行的值 .withColumn("minus", getMinusUdaf($"price").over(winSpec)) //在前面的基础上用UDF也行 .show() /* lag(field, n): 就是取从当前字段往前第n个值，这里是取前一行的值 first/last(): 提取这个分组特定排序的第一个最后一个，在获取用户退出的时候，你可能会用到 lag/lead(field, n): lead 就是 lag 相反的操作，这个用于做数据回测特别用，结果回推条件 */ //——————————————————————以下为自定义聚合函数UDAF—————————————————————————————————————————————— class MyAverage extends UserDefinedAggregateFunction&#123; //继承抽象函数必须实现以下方法 // 输入参数的数据类型 def inputSchema: StructType = StructType(StructField("value", LongType) :: Nil) // 缓冲区中进行聚合时，所处理的数据的类型 def bufferSchema: StructType = StructType(StructField("count", LongType) :: StructField("sum", DoubleType) :: Nil) // 初始化给定的聚合缓冲区，即聚合缓冲区的零值。 请注意，缓冲区内的数组和映射仍然是不可变的。 def initialize(buffer: MutableAggregationBuffer): Unit = &#123; buffer(0) = 0L //表示次数 buffer(1) = 0.0D //表示总和 &#125; //使用来自input的新输入数据更新给定的聚合缓冲区`buffer`。每个输入行调用一次。 def update(buffer: MutableAggregationBuffer, input: Row): Unit = &#123; if (!input.isNullAt(0)) &#123; buffer(0) = buffer.getLong(0) + 1L //次数加1 buffer(1) = buffer.getDouble(1) + input.getAs[Long](0).toDouble //求和 &#125; &#125; // 此函数是否始终在相同输入上返回相同的输出 def deterministic: Boolean = true // 合并两个聚合缓冲区并将更新的缓冲区值存储回“buffer1”。 // 当我们将两个部分聚合的数据合并在一起时调用此方法。 // Spark是分布式的，所以不同的区需要进行合并。 def merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = &#123; buffer1(0) = buffer1.getLong(0) + buffer2.getLong(0) //求次数 buffer1(1) = buffer1.getDouble(1) + buffer2.getDouble(1) //求和 &#125; //计算最终的结果 def evaluate(buffer: Row): Double = &#123; buffer.getDouble(1) / buffer.getLong(0).toDouble &#125; // 返回值的数据类型 def dataType: DataType = DoubleType &#125; class MyMinus extends UserDefinedAggregateFunction&#123; def inputSchema: StructType = StructType(StructField("value", LongType) :: Nil) def bufferSchema: StructType = StructType(StructField("minus", LongType) :: Nil) def initialize(buffer: MutableAggregationBuffer): Unit = &#123; buffer(0) = 0L //表示差值 &#125; def update(buffer: MutableAggregationBuffer, input: Row): Unit = &#123; if (!input.isNullAt(0)) &#123; //输入的后者减去前者 buffer(0) = input.getLong(0) - buffer.getLong(0) &#125; &#125; // 此函数是否始终在相同输入上返回相同的输出 def deterministic: Boolean = true def merge(buffer1: MutableAggregationBuffer, buffer2: Row): Unit = &#123; //分区合并，也是后者减前者 buffer1(0) = buffer2.getLong(0) - buffer1.getLong(0) &#125; //计算最终的结果 def evaluate(buffer: Row): Long = &#123; buffer.getLong(0) &#125; // 返回值的数据类型 def dataType: DataType = LongType &#125; &#125;]]></content>
      <categories>
        <category>spark</category>
      </categories>
      <tags>
        <tag>spark</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[如何使用隐式转换扩展DataFrame和RDD以及其他的对象]]></title>
    <url>%2F2018%2F11%2F30%2F%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2%E6%89%A9%E5%B1%95DataFrame%E5%92%8CRDD%E4%BB%A5%E5%8F%8A%E5%85%B6%E4%BB%96%E7%9A%84%E5%AF%B9%E8%B1%A1%2F</url>
    <content type="text"><![CDATA[目的DataFrame可以点出来很多方法，都是DF内置的。 比如说：df.withColumn()，df.printSchema()。 但是如果你想打印df中的分区位置信息，以及每个key有多少记录。怎么才能点出来这个方法呢？ 实现工具类123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263package utilsimport org.apache.spark.rdd.RDDimport org.apache.spark.sql._//导入对应的规则类，以免出现警告import scala.language.implicitConversionsobject BaseUtil &#123; /** * DF的装饰类（隐式转换） */ class RichDataFrame(dataFrame: DataFrame)&#123; /** * 用来统计相同key的记录数，常用于调整数据倾斜 */ def printKeyNums(column: Column): Unit =&#123; val map = dataFrame.select(column).rdd.countByValue() println(s"一共$&#123;map.size&#125;个key") for ((key, num) &lt;- map) &#123; println(key + "共有" + num + "条记录") &#125; &#125; def printKeyNums(column: String): Unit =&#123; printKeyNums(dataFrame.col(column)) &#125; /** * 打印分区位置信息 */ def printLocation(): Unit =&#123; println("分区位置信息如下==============") dataFrame.rdd.mapPartitionsWithIndex(printLocationFunc).collect().foreach(println(_)) &#125; &#125; /** * 扩展df的方法，隐式转换 */ implicit def df2RichDF(src: DataFrame): RichDataFrame = new RichDataFrame(src) /** * RDD的装饰类（隐式转换）,不加泛型读取不到 */ class RichRDD(rdd:RDD[_ &lt;: Any])&#123; def printLocation(): Unit =&#123; println("分区位置信息如下==============") rdd.mapPartitionsWithIndex(printLocationFunc).collect().foreach(println(_)) &#125; &#125; /** * 扩展RDD的方法，隐式转换 */ implicit def rdd2RichRDD(src: RDD[_ &lt;: Any]): RichRDD = new RichRDD(src) /** * 打印rdd的分区信息，需要用mapPartitionsWithIndex方法。 * 使用方法：df.rdd.mapPartitionsWithIndex(printLocationFunc).collect().foreach(println(_)) */ def printLocationFunc(index: Int, iter: Iterator[Any]): Iterator[String] = &#123; iter.map(x =&gt; "分区" + index + "：" + x + "") &#125;&#125; 测试工具类1234567891011121314import utils.BaseUtil._object DataFrameDemo extends App &#123; val sc = ConnectUtil.sc val spark = ConnectUtil.spark import spark.implicits._ val df = spark.createDataset(Seq(("aaa", 1, 2), ("bbb", 3, 4), ("bbb", 1, 5), ("bbb", 2, 1), ("ccc", 4, 5), ("bbb", 4, 6))).toDF("key1", "key2", "key3") //测试 df.printKeyNums("key1") df.printKeyNums($"key1") df.printLocation() df.rdd.printLocation()&#125;]]></content>
      <categories>
        <category>spark</category>
      </categories>
      <tags>
        <tag>spark</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[spark调优]]></title>
    <url>%2F2018%2F11%2F22%2Fspark%E8%B0%83%E4%BC%98%2F</url>
    <content type="text"><![CDATA[开发调优http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_0S1att3u_Arv2julgO3DfqzJ 资源调优http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1aNUiT0jIkZS2vOo7b2A4zj0 数据倾斜调优http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1Bfyg63sj4Z62ijmli2HNs3A shuffle调优http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_0G6_680iZQjZ2SL00W3Mx2C1 UI界面详解http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_0Z68LH1WJkHy2ZzXL-3sPL0x 常见错误http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_0COQmb073k7328mFz10H6y5g]]></content>
      <categories>
        <category>spark</category>
      </categories>
      <tags>
        <tag>spark</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[软件基本操作]]></title>
    <url>%2F2018%2F11%2F18%2F%E8%BD%AF%E4%BB%B6%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[此文件用来存放为知笔记中的软件基本操作，因为Hexo更新起来太麻烦，所以在这里只保存网址。 Wiz笔记基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_2G5fl23tBkJf2-yhOs0NQAvm GitHub高效利用http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_2xbFqV2d84ar2shT470Q0_00 IDEA基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_2JaDdJ1qykdj2so27N2QbLjp Chrome浏览器基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_29REm81QgAyn2HPyyl0GvLxx 梯子搭建http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_15_uf02yxQIH2uV1rO0fo5_z PyCharm基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_2jTrwm3nfQ1b25SGOL1xSKsy Anaconda基本操作(被PyCharm取代)http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_38Kfp21v9A912ogkRY2_MxcX Photoshop2015基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1wguN430BQVB2m50301ldceA SVN基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1xgVgp3xFkg82m1-4y0agm2S FastStone基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1XtmU22sxQB62DEWke0Q1si9 EditPlus基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1d6UAp2ckklB2WPhk01mXX1i Eclipse维护http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1umKrT2Sik7C2mh7_h3nmLWS Xmind基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_1m1Ppn3JeA6V2XuoT93B3xCi Office基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_07RH0S1PZQTj2R-VY_1KucQu CorelDrawX6基本操作http://4d3810a1.wiz03.com/share/s/1de12x0ssAHg2vQr4b1tgYE_39eROy3TVAaf2C0_OT3UWSXN]]></content>
      <categories>
        <category>软件</category>
      </categories>
      <tags>
        <tag>软件</tag>
      </tags>
  </entry>
</search>
